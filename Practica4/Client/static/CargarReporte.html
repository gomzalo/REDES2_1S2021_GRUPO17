<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Carga de reportes</title>
	<script src="JS/jquery-3.6.0.min.js"></script>
	<link rel="stylesheet" type="text/css" href="JS/bootstrap.css">
</head>
<body>
	<script type="text/javascript">
		var d = new Date();

		var month = d.getMonth()+1;
		var day = d.getDate();

		var fecha = d.getFullYear() + '/' +
			(month<10 ? '0' : '') + month + '/' +
			(day<10 ? '0' : '') + day;
		
			console.log(fecha);
			
		$(document).ready(function(){

			$('#archivos').on("submit",function(e){

				e.preventDefault();
				var carnet = $('#txtCarnet').val();
				var nombre = $('#txtNombre').val();
				var curso_proyecto = $('#txtCursoProyecto').val();
				var cuerpo = $('#txtCuerpo').val();

				if(validar(carnet, nombre, curso_proyecto, cuerpo)){
					//alert("campos validados");
					var settings = {
						"url": "http://localhost:4000/crear?Carnet=" + carnet + "&Nombre=" + nombre + "&Curso=" + curso_proyecto + "&Fecha=" + "26032021" + "&Cuerpo=" + cuerpo,
						"method": "GET",
						"timeout": 0,
						"headers": {
							"Access-Control-Allow-Headers": "Authorization",
							"Content-Type": "application/json"
						},
						// "data": JSON.stringify({"Carnet":2000000,"Nombre":"Dianita3","Curso":"Analisis3","Fecha":"26/03/2021","Cuerpo":"kjfklasdmflk"}),
					};
					console.log(settings.data);
					$.ajax(settings).done(function (response) {
						alert(response);
						location.reload(); 
					});
					//limpiar();
				}

			});

			function validar(carnet, nombre, curso_proyecto, cuerpo){

				if(carnet == ""){
					alert("Ingrese un carnet.");
					$('#txtCarnet').focus();
					return false; 
				}

				if(nombre == ""){
					alert("Ingrse un nombre.");
					$('#txtNombre').focus();
					return false;
				}

				if(curso_proyecto == ""){
					alert("Ingrese el nombre de curso/proyecto.")
					$('#txtCursoProyecto').focus();
					return false;
				}
				if(cuerpo == ""){
					alert("Ingrese el cuerpo del reporte.")
					$('#txtCuerpo').focus();
					return false;
				}

				return true;
			}

			function limpiar(){
				$('#txtCarnet').val('');
				$('#txtNombre').val('');
				$('#txtCursoProyecto').val('');
				$('#txtCuerpo').val('');
			}

			//restringe la entrada solo a numeros
			$('#txtCarnet').on('input', function () { 
			    this.value = this.value.replace(/[^0-9]/g,'');
			});

			$('#btnRegresar').click(function(){
					window.location.href = "index.html";
					return false;
			});

		});
	</script>
	<form id="archivos" name="archivos">
		<br>
		<h1 align="center">Ingreso de Reportes de Practicantes</h1>
		<br>
		<table align="center">
			

			<tr id="divCarnet" name="divCarnet">
				<td>Carnet</td>
				<td>
					<input  id="txtCarnet" name="txtCarnet" style="width: 423px" placeholder="Ingresa un carnet">
				</td>
			</tr>
			<tr id="divNombre" name="divNombre">
				<td  >Nombre</td>
				<td >
					<input id="txtNombre" name="txtNombre" style="width: 423px" placeholder="Ingresa un nombre">
				</td>
			</tr>
			<tr id="divCursoProyecto" name="divCursoProyecto">
				<td  >Curso/Proyecto</td>
				<td >
					<input id="txtCursoProyecto"  name="txtCursoProyecto" style="width: 423px" placeholder="Nombre del Curso/Proyecto">
				</td>
			</tr>
			<tr>
				<td >Cuerpo del reporte</td>
				<td >
					<textarea id="txtCuerpo" name="txtCuerpo" style="width: 423px; resize: none;" rows="10" cols="50" placeholder="Descripcion...."></textarea>
				</td>
			</tr>

		</table>
		<br>
		<center>
			<button type="button" id="btnRegresar" name="btnRegresar" class="btn btn-secondary btn-lg">Regresar</button>
			<button type="submit" id="btnEnviar" name="btnEnviar" class="btn btn-secondary btn-lg">Enviar</button>	
		</center>
		<table align="center">
			
		</table>
	</form>

</body>
</html>